<style>

    body {
        background: transparent;
    }

    #toast-container div {
        font-weight: bold;
    }

    #navglobal {
        box-shadow: 0px 4px 7px #cac5c5;
    }

    header {
        margin-bottom: 0px;
        margin-bottom: -10px;
    }

    main {
        margin-top: 15px;
    }

    #breadcrumb {
        left: 0px;
    }

    #container-list {
        margin-top: 15px;
    }

    /*#menuContexto {*/
        /*width: 100%;*/
        /*background: none;*/
        /*padding-top: 10px;*/
        /*padding-bottom: 10px;*/
        /*border: 1px solid #D2D2D2;*/
        /*box-shadow:  0px 0px 2px #a2a2a2;*/
        /*margin-left: 10px;*/
        /*border-radius: 10px;*/
    /*}*/

    /*#menuContexto #qm0 {*/
        /*width: 100%;*/
        /*!*padding-top: 10px;*!*/
        /*!*padding-bottom: 10px;*!*/

    /*}*/

    /*#menuContexto .qmmc #qm0 {*/
        /*border: none;*/
        /*box-shadow: none;*/
    /*}*/

    /*#menuContexto #qm0 a {*/
        /*position: relative !important;*/
        /*!*width: 100%;*!*/
        /*!*background-position: center center;*!*/
        /*background-image: none;*/
        /*!*border: none;*!*/
        /*!*padding: 10px 5px;*!*/
        /*!*margin: 0px 15px;*!*/
        /*!*font-size: 13px;*!*/
        /*!*font-family: "Roboto", sans-serif;*!*/
        /*!*width:88%;*!*/
        /*border-bottom: 1px solid #d2d2d2;*/
    /*}*/
    /*#menuContexto #qm0 a:not(.no_seta):before {*/
        /*content: "";*/
        /*display: block;*/
        /*position: absolute;*/
        /*right: 16px;*/
        /*width: 0;*/
        /*border-width: 6px 0 6px 6px;*/
        /*border-style: solid;*/
        /*border-color: transparent #666;*/
    /*}*/

    /*#menuContexto #qm0 div,*/
    /*#menuContexto #qm0.sanfonaDiv a {*/
        /*width: 90% !important;*/
    /*}*/

    /*#menuContexto #qm0.sanfonaDiv a:not(.no_seta):before {*/
        /*border: none;*/
    /*}*/

    /*!*#menuContexto #qm0 a:hover {*!*/
        /*!*!*background: inherit;*!*!*/
        /*!*!*color: #ffffff;*!*!*/
    /*!*}*!*/

    /*#menuContexto #qm0 a:last-child {*/
        /*border-bottom: none;*/
    /*}*/

    /*#menuContexto .top {*/
        /*background: none;*/
        /*height: 0;*/
    /*}*/

    /*#menuContexto .bottom {*/
        /*background: none;*/
        /*height: 0;*/
    /*}*/

    /*.sidebar aside h3:after {*/
        /*content: "";*/
        /*display: block;*/
        /*position: absolute;*/
        /*bottom: -9px;*/
        /*left: 10px;*/
        /*width: 0;*/
        /*border-width: 9px 9px 0px 9px;*/
        /*border-style: solid;*/
        /*border-color: #0c451a transparent;*/
    /*}*/

    #rodapeConteudo_com_menu {
        display: none;
    }

    table th {
        font-size: 14px;
        padding: 16px;
        background: transparent;
        color: #212121;
        text-transform: none;
    }

    table td {
        padding: 16px;
        color: #212121;
    }

    table td.action {
        padding-left: 5px;
        padding-right: 5px;
    }

    .collapsible table td {
        padding-top: 7px;
        padding-bottom: 7px;
    }
    .collapsible {
        box-shadow: none;
        border-right: none;
        border-left: none;
    }
    .collapsible-header {
        padding: 8px;
    }

    .collapsible-header.produto {
        text-transform: uppercase;
    }


    .collapsible .collapsible .collapsible-header {
        padding-left: 40px;
    }

    table .left-align {
        text-align: left !important;
    }

    table .right-align {
        text-align: right !important;
    }

    table thead tr.title {
        background: transparent;
    }

    table thead tr.title th {
        text-transform: uppercase;
        text-align: left;
        font-size: 17px;
        /*color: #fff;*/
    }

    .tabs .tab a {
        background: #fff;
        color: #212121;
    }

    .tabs .tab a:hover,
    .tabs .tab a.active {
        background-color: #c8e6c9;
        color: #212121;
    }

    .tabs .indicator {
        background-color: #4caf50;
        right: 1155.38px;
        left: 0px;
        width: 25%;
    }

    form .input_simples:hover,
    form .textarea_simples:hover,
    form .select_simples:hover,
    form .input_simples2:hover,
    form .input_simples,
    form .textarea_simples,
    form .select_simples,
    form .input_simples2 {
        background: none;
    }

    .input-field input[type=text]:focus {
        /*border-bottom: 1px solid #212121;*/
        /*box-shadow: 0 1px 0 0 #212121;*/
    }

    .input-field label,
    .input-field label:hover,
    .input-field:active,
    .input-field:hover,
    .input-field {
        color: #212121;

    }

    input:not([type]):focus:not([readonly]),
    input[type=text]:focus:not([readonly]),
    input[type=password]:focus:not([readonly]),
    input[type=email]:focus:not([readonly]),
    input[type=url]:focus:not([readonly]),
    input[type=time]:focus:not([readonly]),
    input[type=date]:focus:not([readonly]),
    input[type=datetime]:focus:not([readonly]),
    input[type=datetime-local]:focus:not([readonly]),
    input[type=tel]:focus:not([readonly]),
    input[type=number]:focus:not([readonly]),
    input[type=search]:focus:not([readonly]),
    textarea.materialize-textarea:focus:not([readonly]) {
        border-bottom: 1px solid #212121;
        box-shadow: 0 1px 0 0 #212121;
    }

    input:not([type]):focus:not([readonly]) + label,
    input[type=text]:focus:not([readonly]) + label,
    input[type=password]:focus:not([readonly]) + label,
    input[type=email]:focus:not([readonly]) + label,
    input[type=url]:focus:not([readonly]) + label,
    input[type=time]:focus:not([readonly]) + label,
    input[type=date]:focus:not([readonly]) + label,
    input[type=datetime]:focus:not([readonly]) + label,
    input[type=datetime-local]:focus:not([readonly]) + label,
    input[type=tel]:focus:not([readonly]) + label,
    input[type=number]:focus:not([readonly]) + label,
    input[type=search]:focus:not([readonly]) + label,
    textarea.materialize-textarea:focus:not([readonly]) + label {
        color: #212121;
    }

    input[type=text]:disabled + label,
    input[type=text]:disabled,
    input[type=text][readonly="readonly"] + label,
    input.disabled,
    input[type=text][readonly="readonly"] {
        color: rgba(33, 33, 33, 0.54);
    }

    form select.browser-default {
        min-height: 44px;
        background-color: #fafafa;
        border: 1px solid #9e9e9e;;
        width: 100%;

    }

    form textarea.materialize-textarea {
        margin-top: 10px;
        padding: 13px 10px;
        border: 1px solid #9e9e9e;
    }

    .input-field label,
    form label {
        color: #212121;
    }

    .modal.bottom-sheet {
        max-height: 50%;
    }

    .section {
        position: relative;
    }

    .btn-close-modal {
        margin-right: 10px;
    }
    .section  span.badge {
        font-size: 1.2rem;
    }

    span.badge div {
        display: inline;
        margin-left: 30px;
    }

    .section  span.badge  i {
        /*font-size: 1rem;*/
        position: absolute;
        top: 28px;
        margin-right: 30px;
    }

    #custosvinculados .preloader-wrapper{
        display: none;

    }

    .modal.modal-pre-loader {
        width: 300px;
        height: 180px;
        padding: 10px;
    }

    .modal.modal-pre-loader .modal-content {
        padding: 10px;
    }

    .table.bordered > thead > tr.outrasfontes, table.bordered > tbody > tr.outrasfontes {
        background: rgba(205, 200, 230, 0.45);
    }


</style>

<div class="container-fluid">

    <div class="row">

        <?php echo $this->partial("inc/menu.phtml", $this); ?>

        <div class="content col s10 m12 l10 planilha-produtos">
            <?php
            gerarBreadCrumb(array(
                array('Lista de Propostas' => array('controller' => 'manterpropostaincentivofiscal', 'action' => 'listar-propostas')),
                array('Or&ccedil;amento' => '')
            ));
            ?>

            <div class="clearfix"></div>
            <h5 class="light">Custo por produto</h5>
            <?php if( false ) : ?>
            <?php //if( $this->PlanilhaSalvo) : ?>
                <p class="right-align" style="position: absolute; top: 167px; right: 100px">
                    <a id="btn-restaurar-planilha" class="btn-floating waves-effect waves-light btn tooltipped btn-info" data-tooltip="Restaurar planilha"><i class="material-icons left">restore</i></a>
                </p>
            <?php endif; ?>
            <div id="container-list" data-ajax-render='/proposta/manterorcamento/listarprodutos/idPreProjeto/<?php echo( isset($this->idPreProjeto) ) ? $this->idPreProjeto : ''; ?>'><p class="center align">Carregando or&ccedil;amento ...</p></div>

            <div id="custosvinculados" data-ajax-render='/proposta/manterorcamento/resumoplanilha/idPreProjeto/<?php echo( isset($this->idPreProjeto) ) ? $this->idPreProjeto : ''; ?>'></div>
        </div>
    </div>
</div>
    <div id="msg"></div>
    <div id="rodapeConteudo"><span></span></div>
    <br clear="all" />
<div id="modal-pre-loader" class="modal modal-pre-loader">
    <div class="modal-header center valign"><h5>Aguarde!</h5></div>
    <div class="modal-content">
        <div class="row">
            <div class="col s4">
                <div class="preloader-wrapper small active">
                    <div class="spinner-layer spinner-blue-only">
                        <div class="circle-clipper left">
                            <div class="circle"></div>
                        </div><div class="gap-patch">
                            <div class="circle"></div>
                        </div><div class="circle-clipper right">
                            <div class="circle"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col s8">
                <p>Carregando...</p>
            </div>
        </div>
    </div>
</div>

<script>

$(document).ready(function(){
    <?php if (!$this->isEditavel) : ?>
        JSBloquearAlteracaoFormulario();
    <?php endif; ?>
});

$3( document ).ajaxStart(function() {
    $3('#modal-pre-loader').modal('open');
});

$3(document).ajaxComplete(function () {
    $3('#modal-pre-loader').modal('close');
});

$3(document).ready(function () {

    $3('.modal-pre-loader').modal();

    $3('body').on('click', '.btn-salvar', function () {


        var validar = true;
        $3('.valida').each(function () {
            if ($3(this).val() == '') {
                validar = false;
            }
        });

        if (validar == false) {
            Materialize.toast("Dados obrigat&oacute;rios n&atilde;o informados!", 4000);
            return false;
        } else {
            if ($3("#qtd").val() == 0) {
                Materialize.toast('Quantidade n&atilde;o pode ser igual a zero', 4000);
                $3("#qtd").focusin();
                return false;
            }

            if ($3("#ocorrencia").val() == 0) {
                Materialize.toast('Ocorr&ecirc;ncia n&atilde;o pode ser igual a zero', 4000);
                $3("#ocorrencia").focusin();
                return false;
            }

            var vlunitario = $3("#vlunitario").val();
            vlunitario = vlunitario.replace(/\D/g, "");
            vlunitario = vlunitario.replace(/(\d{0})(\d)/, "$1$2");

            if (vlunitario == 0) {
                Materialize.toast('Valor unit&aacute;rio n&atilde;o pode ser igual a zero', 4000);
                $3("#vlunitario").focusin();
                return false;
            }

            if ($3("#qtdDias").val() == 0) {
                Materialize.toast('Quantidade de dias n&atilde;o pode ser igual a zero', 4000);
                $3("#qtdDias").focusin();
                return false;
            }

            $3.post($3('#form').attr('action'), $3('#form').serialize(), function (result) {
                result = $3.parseJSON(result);
                if (result.status == '1') {
                    console.log(result.status + result.action);

                    if( result.action == 'update') {
                        $("#item-planilha-" +result.idPlanilhaProposta).replaceWith(result.html);
                    }
                    else if( result.action == 'insert') {

                        var produto = $3('#produto').val();
                        var etapa = $3('#idPlanilhaEtapa').val();
                        var mun = $3('#municipio').val();

                        var idEtapa = "#etapa" + produto + "" + etapa + "" + mun;

                        $3(idEtapa + " div.info").hide();
                        $3(idEtapa + ' table tbody').append(result.html);
                        $3("#planilhaitem").focus();
                    }

                    if(result.close == '1' )
                        $3('#modal').modal('close');

                    $3('#form')[0].reset();
                    Materialize.toast(result.msg, 4000, 'green white-text');
                    $3.each($('div[data-ajax-render]'), function () {
                        $3.ajaxRender({
                            strUrl: $('#custosvinculados').attr('data-ajax-render'),
                            strTarget: '#custosvinculados'
                        });
                    });
                } else {
                    Materialize.toast(result.msg, 8000, 'red darken-1 white-text');
                }
            });
         }
         return false;
    });
    window.dispatchEvent(new Event('resize'));

    <?php if(false) : ?>
    <?php //if( $this->PlanilhaSalvo) : ?>
        $3('body').on('click', '#btn-restaurar-planilha', function () {

            $3("#msg").html('Tem certeza que deseja restaurar a planilha?\n Esta acao nao podera ser desfeita!');

            $("#msg").dialog
            ({
                width: 350,
                height: 200,
                modal: true,
                draggable: false,
                resizable: false,
                closeOnEscape: false,
                buttons: {
                    'N\xE3o': function () {
                        $(this).dialog('close');
                        $(this).dialog('close');
                    },
                    'Sim': function () {
                        var urlAction = "<?php echo $this->url(array('module' => 'proposta', 'controller' => 'manterorcamento', 'action' => 'restaurarplanilha')); ?>";
                        var dados = { idPreProjeto: <?php echo isset($this->idPreProjeto) ? $this->idPreProjeto : '' ?>};

                        $.post(urlAction, dados, function (result) {
                            result = $3.parseJSON(result)
                            if (result.status == '1') {
                                Materialize.toast(result.msg, 4000, 'green white-text');

                                var divRender = $('div[data-ajax-render]');

                                $3.each($3('div[data-ajax-render]'), function () {
                                    $3.ajaxRender({strUrl: $(this).attr('data-ajax-render'), strTarget: '#' + $(this).attr('id')});
                                });

                            } else {
                                Materialize.toast(result.msg, 8000, 'red darken-1 white-text');
                            }
                        });

                        $(this).dialog('close');
                    }
                }
            });

            $3(".ui-dialog-titlebar-close").remove();

            return false;

        });
    <?php endif; ?>
});
</script>
<script type="text/javascript" src="<?php echo $this->baseUrl(); ?>/public/js/ckeditor/ckeditor.js"></script>
<script type="text/javascript" src="<?php echo $this->baseUrl(); ?>/public/js/ckeditor/_samples/sample.js"></script>
<link type="text/css" rel="stylesheet" href="<?php echo $this->baseUrl(); ?>/public/js/ckeditor/_samples/sample.css" />

<!-- ========== INÍCIO BREADCRUMB (LINKS TOPO) ========== -->
<div id="breadcrumb">
    <ul>
        <li class="first"><a href="<?php echo $this->url(array('controller' => 'principal', 'action' => ''), '', true); ?>" title="Ir para P&aacute;gina Inicial">In&iacute;cio</a></li>
        <li class="second">An&aacute;lise T&eacute;cnica Inicial</li>
        <li class="second"><a href="<?php echo $this->url(array('controller' => 'analisarprojetoparecer', 'action' => 'index'), '', true); ?>" title="Ir para P&aacute;gina Inicial">Projetos/Produtos para An&aacute;lise</a></li>
        <li class="last">An&aacute;lise do Produtos</li>
    </ul>
</div>
<!-- ========== FIM BREADCRUMB (LINKS TOPO) ========== -->



<!-- ========== INÍCIO T�TULO ========== -->
<div id="titulo">
    <div>An&aacute;lise do Produto <span class="voltar"><a href="javascript:voltar();" title="P&aacute;gina Anterior">Voltar</a></span></div>
</div>
<!-- ========== FIM T�TULO ========== -->

<div id="dialog-valor" class="sumir" title="Valor Inv&aacute;lido">
    <div class="msgERROR">
        <div>Valor de remanejamento maior que o permitido! M&aacute;ximo : <span id="valorpossivelApresentacao"></span></div>
    </div>
</div>

<!-- ========== INÍCIO CONTE�DO ========== -->
<div id="conteudo">
    <table class="bordered" >
        <tr>
            <th colspan="6">
              Parecer T&eacute;cnico do Projeto      
            </th>
        </tr>
	<tr>
	  <td width="10%">PRONAC: </td><td><?php echo $this->projeto->PRONAC; ?></td><td colspan="3"><strong><?php echo $this->projeto->NomeProjeto; ?></strong></td>
	</tr>
	<tr>
	  <td width="10%">&Aacute;rea:</td><td><?php echo $this->projeto->dsArea; ?></td><td>Segmento:</td><td><?php echo $this->projeto->dsSegmento; ?></td>
	</tr>
	<tr>
	  <td>Produto:</td>
	  <td colspan="6">
	    <?php
                if ($this->projeto->stPrincipal) {
                    echo 'Principal';
                } else {
                    echo 'Secundario';
                }
                ?>: <?php echo $this->projeto->dsProduto; ?>	
	  </td>
	</tr>
    </table>
    <!-- FIM ANALISE DE CONTE&UACUTE;DO  -->
    <!-- Formulario -->
    <div id="divAnaliseConteudo">
        <form name="formAnaliseConteudo" id="formAnaliseConteudo" action="<?php echo $this->url(array('controller' => 'analisarprojetoparecer', 'action' => 'analisedeconteudo')); ?>" method="post">
            <input type="hidden" id="stAcao" name="stAcao" value="0"/>
            <input type="hidden" name="idPRONAC" value="<?php echo $this->projeto->IdPRONAC; ?>"/>
            <input type="hidden" name="idProduto" value="<?php echo $this->projeto->idProduto; ?>"/>
            <input type="hidden" id="stPrincipal" name="stPrincipal" value="<?php echo $this->projeto->stPrincipal; ?>"/>
            <input type="hidden" id="idD" name="idD" value="<?php echo $this->idD; ?>"/>

            <table class="tabela" style="width: 95%;">
                <tr>
                    <td colspan="5">
                        <b>Parecer t&eacute;cnico*</b>
                        <p>
                        <center>
                            <textarea class="browser-default" id="ParecerDeConteudo" name="ParecerDeConteudo" rows="10"></textarea>
                        </center>
                    </td>
                </tr>
                <tr>
                    <td colspan="5">
                        <b>Posicionamento do parecerista *</b>
                        <p style="margin-top: 10px;">
                            <input type="radio" style="margin-right: 5px;" value="1" class="ParecerFavoravel" name="ParecerFavoravel" checked="checked" />Parecer favor&aacute;vel &nbsp;&nbsp;
                            <input type="radio" style="margin-right: 5px;" value="0" class="ParecerFavoravel" name="ParecerFavoravel" />Parecer desfavor&aacute;vel
                        </p>
                    </td>
                </tr>
		
                <tr id="btSalvar">
                    <td colspan="6" align="center">
                        <div class="input-field col s12 center">
                            <button class="btn waves-effect waves-light" type="submit" name="action">Salvar
                                <i class="material-icons right">send</i>
                            </button>
                        </div>
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <div id="confirmacao" style="display: none;"></div>
    <!-- FIM MODAL -->
</div>
<!-- ========== FIM CONTE&UACUTE;DO ========== -->

<div id="confirma" class="sumir"></div>
<div id="camposObrigatorios" class="sumir"></div>

<!-- ========== INÍCIO RODAP� DO CONTE&UACUTE;DO ========== -->
<div id="rodapeConteudo"><span></span></div>
<!-- ========== FIM RODAP� DO CONTE&UACUTE;DO ========== -->
<input type="hidden" name="grupoAtivo" id="grupoAtivo" value="<?php echo $this->grupoAtivo; ?>" />
<br clear="all" />

<script type="text/javascript">

    $(document).ready(function () {
        carregarAnaliseDeConteudo();
	
	$("#formAnaliseConteudo").validate({
	    rules: {
                ParecerDeConteudo: {required: true}
            },
            messages: {
                ParecerDeConteudo: {
                    required: function () {
                        return "<br>Dado obrigat&oacute;rio n&atilde;o informado"
                    }
                }
            },
            submitHandler: function (form) {
                form.submit();

            }, invalidHandler: function (event, validator) {

                var errors = validator.numberOfInvalids();
                if (errors) {
                    var message = errors == 1
                        ? 'Voc&ecirc; possui 1 campo com erro. Ele foi destacado abaixo'
                        : 'Voc&ecirc; possui ' + errors + ' campos com erros. Eles foram destacados abaixo';
                    $("div.error span").html(message);
                    $("div.error").show();
                } else {
                    $("div.error").hide();
                }
            }

        });

    }); //fecha document.ready

    function carregarAnaliseDeConteudo()
    {
        recuperaFormulario($('#formAnaliseConteudo').attr('action'),{stAcao: 1, idPRONAC: <?php echo $this->projeto->IdPRONAC; ?>, idProduto: <?php echo $this->projeto->idProduto; ?>, stPrincipal:<?php echo $this->projeto->stPrincipal; ?>});
        return true;
    }

function recuperaFormulario(url,params){   
        if(params.length < 1)
        {
            params = {};
        }
        var btSalvar = false;
    $.post(url,params,function(data){
            if(data){
                $('#formAnaliseConteudo').find('input, select, textarea').each(function(key, object){
                    if($(object).attr('type') == 'radio'){
                        if($(object).val() == data[$(object).attr('name')]){
                            btSalvar = true;
                            $(object).attr('checked','true');
                        }
                    }else{
                        if($(object).attr('type') == 'checkbox'){
                            if(data[$(object).attr('name')] == 1){
                                btSalvar = true;
                                $(object).attr('checked','true');
                            }
                        }else{
                            btSalvar = true;
                            if($(object).attr('type') == 'textarea'){
				$(object).text(data[$(object).attr('name')]);

				$(object).editorRico({
				    altura: 400,
				    maxchar: 8000,
				    isLimitarCarateres : true,
				    isDesabilitarEdicao: 0
				});
			    } else {
                                $(object).val(data[$(object).attr('name')]);
			    }
                        }
                    }
                });
                $('#stAcao').val(2);
            }else{
                $('#stAcao').val(3);
            }
        },'json');
    }

</script>
